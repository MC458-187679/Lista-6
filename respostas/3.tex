\begin{theorem}[subestrutura ótima]
    Seja $n$ um inteiro com representação mínima \\$T = [t_0, t_1, \ldots, t_k]$, sendo $k > 0$. Então, $[t_1, \ldots, t_k]$ é uma representação mínima de $\dfrac{n - t_0}{3}$.
\end{theorem}

\begin{proof}[\textbf{Demonstração}]
    Considere $m = (n - t_0) / 3$ e sua representação mínima $R = [r_0, r_1, \ldots, r_{l^*}]$ de tamanho $l^*$. Suponha agora uma representação $S = [s_0, \ldots, s_l]$ de $m$ que não é ótima, isto é, $l > l^*$. Assim, temos que:
    \begin{align*}
        n &= 3 m + t_0 \\
        &= t_0 + 3 \left(r_0 + r_1 \cdot 3 + \cdots + r_{l^*} \cdot 3^l\right) \\
        &= t_0 + r_0 \cdot 3 + r_1 \cdot 3^2 + \cdots + r_{l^*} \cdot 3^{l^*+1}
    \end{align*}
    Então, temos a representação $R' = [t_0, r_0, \ldots, r_{l^*}]$ para $n$. Da mesma forma, temos que $S' = [t_0, s_0, \ldots, s_l]$ representando o mesmo número. Entretanto,
    \[
        \abs{R'} = \abs{R} + 1 = l^* + 2 < l + 2 = \abs{S} + 1 = \abs{S'}
    \]

    Ou seja, a representação $S'$ não é ótima. Portanto, pela contrapositiva, para qualquer representação $A$ de $n$, se ela for mínima, $A - [t_0]$ será uma representação mínima de $m$. Como $T$ é ótima, o teorema segue.
\end{proof}

% ~

% Considere que $C_i$ é o menor custo de um percurso da aldeia $A_i$ para a $A_n$, sendo $1 \leq i < n$. Como os subpercursos são ótimos, podemos considerar todas as possíveis paradas $A_{i < j \leq n}$ com seus percursos ótimos até $A_n$, tomando o menor deles como parte do percurso ótimo de $A_i$. Note que se $i = n$, então não resta nenhuma aldeia no percurso, ou seja, $C_i = 0$. Assim,
% \begin{align*}
%     C_i &= \min_{i < j \leq n}\left\{t_{i, j} + C_j\right\} \\
%     C_n &= 0
% \end{align*}

% Nessa relação, o custo ótimo $C_i$ depende apenas dos custos $C_j$ das aldeias seguintes, com $i < j$, já que $t_{i, j} > 0$ e não é possível alugar uma canoa de $A_{j > i}$ para $A_i$. Assim, podemos calcular os custo a partir da última aldeia $A_n$, sem necessidade de recursão ou memorização.

% \itemdsep
% \subsection{b}

\begin{codebox}
    \Procname{$\proc{Mínimo-Dígitos}(n)$}
    \li $k \gets -1$
    \li
    \li \kw{enquanto} $n > 0$
        \Do
    \li     $k \gets k + 1$
    \li     \kw{se} $k \modulo 3 \isequal 0$ \kw{então}
            \Do
    \li         $n \gets n / 3$
            \End
    \li     \kw{senão}, \kw{se} $k \modulo 3 \isequal 1$ \kw{então}
            \Do
    \li         $n \gets (n - 1) / 3$
            \End
    \li     \kw{senão} ~ ~ ~ \Comment{$k \modulo 3 \isequal 2$}
            \Do
    \li         $n \gets (n + 1) / 3$
            \End
        \End
    \li
    \li \kw{retorna} $k$
\end{codebox}

\begin{codebox}
    \Procname{$\proc{Mínimo-Dígitos}(n)$}
    \li \kw{se} $n \isequal 1$ \kw{então}
        \Do
    \li     \kw{retorna} $0$
        \End
    \li
    \li \kw{senão}, \kw{se} $k \modulo 3 \isequal 0$ \kw{então}
        \Do
    \li     \kw{retorna} $\proc{Mínimo-Dígitos}(n / 3)$
        \End
    \li
    \li \kw{senão}, \kw{se} $k \modulo 3 \isequal 1$ \kw{então}
        \Do
    \li     \kw{retorna} $\proc{Mínimo-Dígitos}((n - 1) / 3)$
        \End
    \li
    \li \kw{senão} ~ ~ ~ \Comment{$k \modulo 3 \isequal 2$}
        \Do
    \li     \kw{retorna} $\proc{Mínimo-Dígitos}((n + 1) / 3)$
        \End
\end{codebox}

% \itemdsep
% \subsection{c}

% Vamos considerar que as linhas \ref{linha:a1:1} e \ref{linha:a1:2} executam em tempo constante $a_1$, que a \ref{linha:a2:1} e a \ref{linha:a2:2} executam em $a_2$ e que \ref{linha:a3:1} e \ref{linha:a3:2} são em tempo $a_3$. Assim, podemos descrever o tempo de execução do algoritmo por:
% \begin{align*}
%     T(n) &= a_1 + \sum_{i = 1}^{n - 1}\left(a_2 + \sum_{j = i + 1}^{n - 1} a_3\right) \\
%     &= a_1 + \sum_{i = 1}^{n - 1} a_2 + a_3 \sum_{i = 1}^{n - 1} n - a_3 \sum_{i = 1}^{n - 1} i - a_3 \sum_{i = 1}^{n - 1} 1 \\
%     &= a_1 + a_2 (n - 1) + a_3 n (n - 1) - a_3 \frac{n (n - 1)}{2} - a_3 (n - 1) \\
%     &= \frac{a_3}{2} n^2 + \frac{2 a_2 - 3 a_3}{2} n + a_1 - a_2 + a_3
% \end{align*}

% Ou seja, $T(n) \in \Theta\left(n^2\right)$, como requerido. Além disso, o único espaço adicional é do vetor $C$ de tamanho $n - 1$. Então, a complexidade de espaço será dada por:
% \begin{align*}
%     E(n) &= n - 1 + \Theta(1) = \Theta(n)
% \end{align*}

\[
    T(n) = T(n / 3) + \Theta(1) \in \Theta(\log(n))
\]
